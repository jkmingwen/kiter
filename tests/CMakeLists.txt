cmake_minimum_required(VERSION 2.8.12)

FIND_PACKAGE( Boost 1.33.0 COMPONENTS unit_test_framework  REQUIRED)

FILE(GLOB_RECURSE TEST_FILES *Test.cpp)

MESSAGE(STATUS "prepare sources: ${SOURCE_FILES}")
MESSAGE(STATUS "prepare tests: ${TEST_FILES}")

FOREACH(TEST_FILE  ${TEST_FILES})
	GET_FILENAME_COMPONENT(TEST_NAME ${TEST_FILE} NAME_WE)
	MESSAGE(STATUS "Add ${TEST_NAME} - ${TEST_FILE}")
	ADD_EXECUTABLE(${TEST_NAME} ${TEST_FILE})
	target_link_libraries(${TEST_NAME} ${KITER_LIBRARIES})
	TARGET_INCLUDE_DIRECTORIES(${TEST_NAME}  PRIVATE ${KITER_INCLUDE_DIR} )
	add_test(NAME ${TEST_NAME} COMMAND ${TEST_NAME}  --log_level=all --report_level=detailed  --detect_memory_leak=1)
ENDFOREACH()
